# SaaS管理ツール POC 開発計画

---

## 0. POCの目的

| 項目 | 内容 |
| --- | --- |
| ゴール | 自社開発で現場課題を解決できることを実証し、DXECO導入（年204万円）の代替判断材料とする |
| デモ対象 | バルくん・現場管理者（先行導入部署） |
| 開発者 | 1名（自分） |
| 技術スタック | Rails 8 + PostgreSQL + Entra ID認証 |
| 開発支援 | AI（Claude等）活用で高速開発 |

## 1. POCで証明すべきこと

現場ヒアリングで判明した最重要課題に対して、自社開発で解決できることを示す。

| # | 証明すべきこと | DXECOとの差別化ポイント | 状態 |
| --- | --- | --- | --- |
| 1 | **アンケート（棚卸し・PW更新）が動く** | DXECOと同等。年200万円払わなくても作れる | **実証済み** |
| 2 | **入退社タスク管理が動く** | DXECOと同等（チェックリスト＋プリセット） | **実証済み** |
| 3 | **申請→承認フローが動く** | **DXECOにない機能**（製品資料で未確認） | **実証済み** |
| 4 | **Entra ID連携で退職者を自動検出できる** | **DXECOにない機能**（台帳と検知が連動） | **実証済み** |
| 5 | **260件のSaaSを手動登録・管理できる** | DXECOと同等だが、カスタマイズ自由 | **実証済み** |
| 6 | **セキュリティ（監査ログ）が標準装備** | DXECOは有料オプション（年24万円追加） | **実証済み** |

## 2. POCスコープ（実装状況）

### 当初POC範囲 → 全機能実装済み

| 機能 | 状態 |
| --- | --- |
| Entra ID SSO認証 | **実装済み** |
| SaaS台帳CRUD | **実装済み** |
| アカウント管理（手動登録＋CSV取込） | **実装済み** |
| アカウントサーベイ（棚卸しアンケート） | **実装済み** |
| 入退社タスク管理（チェックリスト） | **実装済み** |
| SaaS利用申請・承認フロー | **実装済み** |
| 退職者アカウント検出（Entra ID連携） | **実装済み** |
| 操作ログ | **実装済み** |

### 当初POC範囲外 → 追加実装済み

| 機能 | 当初の判断 | 現状 |
| --- | --- | --- |
| SaaSアカウント自動同期（Entra ID連携） | 後回し | **実装済み**（Entra IDエンタープライズアプリ経由） |
| コストダッシュボード（グラフ） | 後回し | **実装済み**（Chart.js カテゴリ別ドーナツチャート） |
| メール通知 | 本番で追加 | **実装済み**（Action Mailer + Solid Queue） |
| CSV エクスポート | 未定 | **実装済み**（SaaS台帳・アカウント・操作ログ） |
| 契約更新アラート | 未定 | **実装済み**（30日/7日前＋期限切れ検出 + Teams通知） |
| パスワード有効期限検出 | 未定 | **実装済み**（90日ポリシー、ダッシュボード表示） |
| エラー監視・アラート通知 | 未定 | **実装済み**（ErrorSubscriber + Azure Monitor） |
| グループベース同期 | 未定 | **実装済み**（ENTRA_SYNC_GROUP_ID指定でグループメンバーのみ同期） |

### 未実装（将来検討）

| 機能 | 理由 |
| --- | --- |
| シャドーIT検知 | ブラウザ拡張が必要。優先度低 |
| IT資産管理（PC・携帯） | SaaS管理が軌道に乗ってから拡張 |
| Terraform IaC | 本番移行時にコード化 |
| 多段階承認フロー | 実運用フロー確定後に対応 |

## 3. 実装済み機能一覧（全16機能）

| # | 機能 | 分類 | 概要 |
| --- | --- | --- | --- |
| 01 | ダッシュボード | コア | KPIカード、承認待ち、タスク進捗、契約更新、コスト概況、PW期限 |
| 02 | SaaS台帳 | コア | CRUD、検索・フィルタ、CSV入出力、契約情報、Entra IDアプリ連携 |
| 03 | アカウント管理 | コア | ユーザー×SaaSマッピング、CSV入出力、ステータス管理 |
| 04 | メンバー管理 | コア | Entra ID同期、部署・役職、SaaS保有一覧、ロール管理 |
| 05 | サーベイ | 差別化 | 棚卸し・PW更新、配信・回答・集計、未回答リマインド、タスク自動生成 |
| 06 | タスク管理 | 差別化 | プリセットテンプレート、入退社・異動対応、チェックリスト、担当者割当 |
| 07 | 申請・承認 | 差別化 | SaaS追加/アカウント追加・削除、承認/却下、メール＋Teams通知 |
| 08 | バッチ管理 | 運用 | Entra同期、退職者検出、契約更新チェック、SaaSアカウント同期、実行履歴 |
| 09 | 操作ログ | セキュリティ | 全CRUD操作の自動記録、変更前後差分(JSONB)、CSV出力 |
| 10 | 認証・認可 | セキュリティ | Entra ID SSO (OIDC)、3段階RBAC、セッション管理 |
| 11 | CSV取込 | データ連携 | SaaS台帳・アカウントの一括登録、テンプレートDL、バリデーション |
| 12 | メール通知 | 通知 | タスク・承認・サーベイの3系統、deliver_later (Solid Queue) |
| 13 | 契約更新アラート | 通知 | 30日/7日前＋期限切れ検出、Teams通知、バッチ実行 |
| 14 | コスト可視化 | BI | 月額/年額集計、カテゴリ別ドーナツチャート (Chart.js) |
| 15 | CSVエクスポート | データ連携 | SaaS台帳・アカウント・操作ログのフィルタ付きCSV出力 |
| 16 | SaaSアカウント同期 | データ連携 | Entra IDエンタープライズアプリからSSO連携済みアカウント自動同期、PW期限検出 |

## 4. 品質指標

| 指標 | 値 |
| --- | --- |
| RSpec テスト数 | 291 |
| Playwright E2E テスト数 | 73 |
| テストカバレッジ（行） | 95.6% |
| テストカバレッジ（分岐） | 77.7% |
| Rubocop 違反 | 0 |
| Brakeman 警告 | 0 |
| CI ジョブ数 | 5 (lint / scan_ruby / scan_js / test / e2e) |

## 5. 通知チャネル

| チャネル | 用途 | 仕組み |
| --- | --- | --- |
| Teams（一般） | タスク割当、承認リクエスト、退職者検出、契約更新アラート | Power Automate Webhook |
| Teams（サーベイ） | サーベイ配信・リマインド | Power Automate Webhook |
| Teams（エラー） | アプリエラー検知、コンテナ再起動アラート | Power Automate Webhook + Azure Monitor |
| メール | タスク割当、承認通知、サーベイ配信・リマインド | Action Mailer + SMTP |

## 6. デモシナリオ

| # | シナリオ | 操作 | 証明すること |
| --- | --- | --- | --- |
| 1 | Entra IDでログイン | ログインボタン → MSログイン → 自動でユーザー情報反映 | Entra ID連携が動く |
| 2 | SaaS台帳を確認 | 事前投入した30件のSaaSを一覧・検索・フィルタ | 台帳管理の基本動作 |
| 3 | コスト可視化を確認 | ダッシュボードのコストカード・カテゴリ別チャート | **コスト可視化** |
| 4 | 棚卸しアンケートを配信 | サーベイ作成 → メンバーに配信 → 回答 → 結果確認 | **アンケート機能（DXECOと同等）** |
| 5 | サーベイからタスク自動生成 | 未利用回答 → ワンクリックでアカウント削除タスク生成 | **サーベイ→タスク連携** |
| 6 | 退職者のアカウントを検出 | Entra ID同期 → 退職者の残存アカウント一覧を表示 | **Entra ID連携（DXECOにない）** |
| 7 | 退職処理タスクを生成 | 退職者を選択 → チェックリスト自動生成 → 各担当者に割当 | **タスク管理（DXECOと同等）** |
| 8 | SaaS利用申請を出す | 申請フォーム入力 → 承認者が承認 → 台帳に反映 | **承認フロー（DXECOにない）** |
| 9 | 操作ログを確認 | 管理画面で変更履歴を表示 → CSV出力 | **監査ログ（DXECOは有料）** |

---

作成日: 2026年2月10日
最終更新: 2026年2月15日
