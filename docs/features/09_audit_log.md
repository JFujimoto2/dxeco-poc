# 操作ログ

## 概要
システム内の全操作（作成・更新・削除）を自動記録し、コンプライアンスとセキュリティ監査に対応する。変更前後の値を差分として保持する。

## URL
| 画面 | URL |
|------|-----|
| 一覧 | `GET /admin/audit_logs` |
| 詳細 | `GET /admin/audit_logs/:id` |

## 記録対象
Auditable concernを含むモデルの全操作が自動記録される。

| リソース | 記録される操作 |
|----------|---------------|
| Saas | 作成 / 更新 / 削除 |
| SaasAccount | 作成 / 更新 / 削除 |
| User | 作成 / 更新 |
| Task | 作成 / 更新 |
| TaskItem | 更新 |
| Survey | 作成 / 更新 |
| ApprovalRequest | 作成 / 更新 |

## データ項目

### 一覧表示
| 項目 | 説明 |
|------|------|
| 日時 | 操作のタイムスタンプ（JST） |
| 操作 | create / update / delete（バッジ表示） |
| リソース | 対象モデル名 + ID |
| ユーザー | 操作を行ったユーザー（バッチの場合はシステム） |
| IPアドレス | 操作元のIPアドレス |

### 詳細表示
| 項目 | 説明 |
|------|------|
| 変更内容テーブル | フィールド名 / 変更前（赤） / 変更後（緑） |

## 一覧画面のフィルタ
- **リソース種別**: ドロップダウンで特定モデルに絞り込み
- **ユーザー**: 特定ユーザーの操作に絞り込み
- **日付範囲**: 開始日〜終了日で期間指定
- **ページネーション**

## 技術的な仕組み
- `Auditable` concern をモデルにincludeすると自動的にログが記録される
- `after_create` / `after_update` / `after_destroy` コールバックで記録
- `changes_data` カラムにJSON形式で変更差分を保存

## アクセス権限
| ロール | 権限 |
|--------|------|
| admin | フル閲覧 |
| manager | アクセス不可 |
| viewer | アクセス不可 |
